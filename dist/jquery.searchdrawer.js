!function(e){function n(e){return s=c,e.attr("id")?(c.selectors.elementId=e.attr("id"),c.$element=e,c.$element.data("data-flydrawr",""),l(),o(),void t()):void console.log("flydrawr: no id on element")}function o(n){e.extend(c.selectors,{button:"[data-flydrawr-id="+c.selectors.elementId+"]",input:"#"+c.selectors.elementId+" .flydrawr-search-input",body:"body",bodyIsOpen:"flydrawr-open-"+c.selectors.elementId,mimic:"#"+c.selectors.elementId+" .flydrawr-search-mimic span"})}function l(){c.$element.addClass("flydrawr-search-box");var n='<input type="text" data-flydrawr-input="'+c.selectors.elementId+'" class="flydrawr-search-input">',o='<div class="flydrawr-search-mimic"><span></span></div>',l=e("<div>"+n+o+"</div>");c.$element.append(l)}function t(){function n(){console.log("add blur"),e(document).on("click",l)}function o(){console.log("remove blur"),e(c.selectors.input).off("blur")}function l(n){var o=e(n.target);o.is(c.$element)||o.is(e(c.selectors.input))||(console.log("toggle:blur"),c.isOpen&&!c.blockToggle&&i())}function t(){e(c.selectors.mimic).html(e(this).val())}function s(e){27==e.keyCode&&i()}e(c.selectors.button).on("click",i.bind(this)),e(c.selectors.input).on("focus",n),c.$element.on("fly:finishedClosing",o),e(c.selectors.input).on("keydown",t),e(c.selectors.input).on("keyup",t),e(c.selectors.input).on("keyup",s)}function i(n){function o(n){var o=!c.isOpen,l=new e.Deferred;return console.log("toggle:"+(o?"open":"close")),o?(e(c.selectors.body).addClass(c.selectors.bodyIsOpen),e(c.selectors.input).eq(0).focus()):e(c.selectors.body).removeClass(c.selectors.bodyIsOpen),setTimeout(function(){c.isOpen=o,l.resolve()}.bind(this),600),l}console.log("throttle"),c.blockToggle||(c.blockToggle=!0,o(n).then(function(){c.blockToggle=!1,c.isOpen?c.$element.trigger("fly:finishedOpening"):c.$element.trigger("fly:finishedClosing")}))}var r={};e.fn.flyDrawer=function(o){return e.extend(c.options,r,o),n(this),{blockToggle:c.blockToggle}};var c={$element:null,selectors:{elementId:null,input:null,button:null,body:"body",bodyIsOpen:null,mimic:null},blockToggle:!1,isOpen:!1,options:null}}(jQuery);